!function(b){"use strict";b.fn.jQCloud=function(x,k){function e(){for(var p=function(e,t){for(var i,h,n=0,n=0;n<t.length;n++)if(i=e,h=t[n],Math.abs(2*i.offsetLeft+i.offsetWidth-2*h.offsetLeft-h.offsetWidth)<i.offsetWidth+h.offsetWidth&&Math.abs(2*i.offsetTop+i.offsetHeight-2*h.offsetTop-h.offsetHeight)<i.offsetHeight+h.offsetHeight)return!0;return!1},e=0;e<x.length;e++)x[e].weight=parseFloat(x[e].weight,10);function i(e,t){var i,h=R+"_word_"+e,n=6.28*Math.random(),o=0,r=0,a=0,s=5,d="";if(t.html=b.extend(t.html,{id:h}),t.html&&t.html.class&&(d=t.html.class,delete t.html.class),x[0].weight>x[x.length-1].weight&&(s=Math.round((t.weight-x[x.length-1].weight)/(x[0].weight-x[x.length-1].weight)*9)+1),i=b("<span>").attr(t.html).addClass("w"+s+" "+d),h=t.link?("string"==typeof t.link&&(t.link={href:t.link}),k.encodeURI&&(t.link=b.extend(t.link,{href:encodeURI(t.link.href).replace(/'/g,"%27")})),b("<a>").attr(t.link).text(t.text)):t.text,i.append(h),t.handlers)for(var f in t.handlers)t.handlers.hasOwnProperty(f)&&"function"==typeof t.handlers[f]&&b(i).bind(f,t.handlers[f]);y.append(i);var l=i.width(),c=i.height(),g=k.center.x-l/2,u=k.center.y-c/2,w=i[0].style;for(w.position="absolute",w.left=g+"px",w.top=u+"px";p(i[0],M);){if("rectangular"===k.shape)switch(++r*m>(1+Math.floor(a/2))*m*(a%4%2==0?1:v)&&(r=0,a++),a%4){case 1:g+=m*v+2*Math.random();break;case 2:u-=m+2*Math.random();break;case 3:g-=m*v+2*Math.random();break;case 0:u+=m+2*Math.random()}else o+=m,n+=(e%2==0?1:-1)*m,g=k.center.x-l/2+o*Math.cos(n)*v,u=k.center.y+o*Math.sin(n)-c/2;w.left=g+"px",w.top=u+"px"}k.removeOverflowing&&(g<0||u<0||g+l>k.width||u+c>k.height)?i.remove():(M.push(i[0]),b.isFunction(t.afterWordRender)&&t.afterWordRender.call(i))}x.sort(function(e,t){return e.weight<t.weight?1:e.weight>t.weight?-1:0});var m="rectangular"===k.shape?18:2,M=[],v=k.width/k.height;k.delayedMode?function e(t){t=t||0,y.is(":visible")?t<x.length?(i(t,x[t]),setTimeout(function(){e(t+1)},10)):b.isFunction(k.afterCloudRender)&&k.afterCloudRender.call(y):setTimeout(function(){e(t)},10)}():(b.each(x,i),b.isFunction(k.afterCloudRender)&&k.afterCloudRender.call(y))}var y=this,R=y.attr("id")||Math.floor(1e6*Math.random()).toString(36),t={width:y.width(),height:y.height(),center:{x:(k&&k.width?k.width:y.width())/2,y:(k&&k.height?k.height:y.height())/2},delayedMode:50<x.length,shape:!1,encodeURI:!0,removeOverflowing:!0};return k=b.extend(t,k||{}),y.addClass("jqcloud").width(k.width).height(k.height),"static"===y.css("position")&&y.css("position","relative"),setTimeout(function(){e()},10),y}}(jQuery);